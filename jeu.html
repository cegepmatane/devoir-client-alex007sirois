<canvas id="map" width="1000" height="500"></canvas>

<script>
	player1VerticalPosition=player2VerticalPosition=40;
	panelThickness=10;
	panelHeight=100;
	ballHorizontalPosition=ballVerticalPosition=50;
	ballDimension=6;
	ballXspeed=ballYspeed=4;
	player2Score=player1Score=0;

	aiSpeed=3;

	var map2d;

	window.onload=function start()
	{
		var map = document.getElementById('map');
		map2d = map.getContext('2d');
		setInterval(update, 1000/60);
		map.addEventListener('mousemove', function(e)
		{
			player1VerticalPosition = e.clientY-panelHeight/2;
		});
	}

	function update()
	{
		ballHorizontalPosition+=ballXspeed;
		ballVerticalPosition+=ballYspeed;

		ai();

		collisions();

		draw();
	}

	function collisions()
	{
		if(ballVerticalPosition<0 && ballYspeed<0 || ballVerticalPosition>map.height && ballYspeed>0)
		{
			ballYspeed*=-1;
		}

		if(ballHorizontalPosition>=4&&ballHorizontalPosition<=panelThickness && ballVerticalPosition>player1VerticalPosition && ballVerticalPosition<player1VerticalPosition+panelHeight)
		{
			ballXspeed*=-1;
		}
		if(ballHorizontalPosition<=map.width-4&&ballHorizontalPosition>map.width-panelThickness && ballVerticalPosition>player2VerticalPosition && ballVerticalPosition<player2VerticalPosition+panelHeight)
		{
			ballXspeed*=-1;
		}
		if(ballHorizontalPosition<0)
		{
			score(2);
		}
		if(ballHorizontalPosition>map.width)
		{
			score(1);
		}
	}

	function draw()
	{
		map2d.fillStyle='black';
		map2d.fillRect(0,0,map.width, map.height);/*background*/

		map2d.fillStyle='white';
		map2d.fillRect(4, player1VerticalPosition, panelThickness, panelHeight);/*p1*/
		map2d.fillRect(map.width-panelThickness-4, player2VerticalPosition, panelThickness, panelHeight);/*p2*/
		/*Ball*/map2d.fillRect(ballHorizontalPosition-ballDimension/2, ballVerticalPosition-ballDimension/2, ballDimension, ballDimension);
		map2d.fillText(player1Score, (map.width/2)-150, 150);
		map2d.fillText(player2Score, (map.width/2)+150, 150);
	
	}

	function ai()
	{
		if(player2VerticalPosition>ballVerticalPosition)
		{
			player2VerticalPosition-=aiSpeed;
		}
		else
		{
			player2VerticalPosition+=aiSpeed;
		}
	}

	function score(player)
	{
		if(player==1)
		{
			player1Score++;
		}
		else
		{
			player2Score++;
		}

		reset();
	}

	function reset()
	{
		ballHorizontalPosition=map.width/2;
		ballVerticalPosition=map.height/2;
		ballXspeed*=-1;
	}
</script>